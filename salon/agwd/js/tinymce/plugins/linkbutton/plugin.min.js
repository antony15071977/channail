

tinymce.PluginManager.add('linkbutton', function(editor, url) {
  // Add a button that opens a window
  
var agww = document.body.clientWidth;
var agwh = $(window).height();

if (agww < 1000) {
	   agww = agww*90/100;
	   agwh = agwh*80/100;
} else {
	   agww = agww*50/100;
	   agwh = agwh*50/100;
}
  
  editor.addButton('linkbutton', {
    text: 'Кнопка',
    icon: 'link',
	title: 'Кнопка-ссылка',
    onclick: function() {
      // Open window
      editor.windowManager.open({
		
	   
        
       
		width: agww,
        height: agwh,
		
         title: 'Вставить кнопку',
        body: [
          {type: 'filepicker', name: 'url', label: 'Адрес перехода или файл:'},
		  {type: 'textbox', name: 'title', label: 'Текст на кнопке:'},
	  
	      {name:"target",type:"listbox",label:"Режим перехода",values:([{text:"None",value:""},{text:"New window",value:' target="_blank"'}])}
		 
		  
        ],
        onsubmit: function(e) {
          // Insert content when the window form is submitted
          editor.insertContent('<a href="' + e.data.url + '"' + e.data.target + ' class="ag_button">' + e.data.title + '</a>');
        }
		
      });
    }
  });

  // Adds a menu item to the tools menu
  
});